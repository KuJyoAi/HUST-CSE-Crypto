- 几个难记的地方:

1. PGP的设计模型
2. ECB和CBC的密文挪用
3. 分组密码工作模式

4. HMAC CBC_MAC

5. SM2(椭圆曲线), SM3(消息摘要), SM4(对称加密)
6. 椭圆曲线公式
7. hash结构

![image-20230627201200794](./assets/image-20230627201200794.png)



# 第一章 古典密码

## 移位密码

$$
e_k(x) = (x+k)mod\space 26
$$

- k=3为凯撒密码

## 代换密码

$$
e_{\pi}(x) = \pi(x) 
$$

## 仿射密码

$$
y = e_k(x)=(ax+b)mod\space 26 \\
d_k(y)=a^{-1}(y-b)mod \space 26
$$

- 几点注意

$$
a满足gcd(a,26)=1, \\
a的取值为\varphi(26)=12
$$

- 分析方法: 根据频率猜两个字母, 解方程得到a,b, 用a是否与26互素判断, 然后再根据明文判断

## 维吉尼亚密码

- 多个移位密码(多表代换, m个表)

- 密码分析

​	关键是得到m:

1. Kasiski法: 找重复的三个或多个字符, m必然是这个距离的因数
2. 重合指数法

### 重合指数

![image-20230616164756241](./assets/image-20230616164756241.png)

![image-20230616164816232](./assets/image-20230616164816232.png)

![image-20230616164902658](./assets/image-20230616164902658.png)

## 希尔密码

$$
x=(x_1,x_2,...x_m) , k为m\times m矩阵\\
e_k(x) = xk
$$

- 密码分析

![image-20230616165309231](./assets/image-20230616165309231.png)



### 矩阵求逆

![image-20230616163216022](./assets/image-20230616163216022.png)

- 公式

![image-20230616163254775](./assets/image-20230616163254775.png)

- 正对角交换, 负对角加负号, **然后乘上行列式的逆**

![image-20230616164001549](./assets/image-20230616164001549.png)

- 用上面的伴随矩阵**乘以行列式的逆**即可



## 置换密码

![image-20230616164115622](./assets/image-20230616164115622.png)

注意x1,x2都是数字

- 是希尔密码的特殊形式(对应位置为1, 其他为0)

## 密码分析(攻击)类型

![image-20230616164315188](./assets/image-20230616164315188.png)

## 流密码

### 分类

- 按周期: 周期流密码和非周期流(OTP)
- 按产生方式: 同步流密码(独立于信息流, OFB), 异步流(由前面的n个明密文推导, CFB)

### LFSR(线性反馈移位寄存器)

![image-20230616201845081](./assets/image-20230616201845081.png)

![image-20230616201903042](./assets/image-20230616201903042.png)

![image-20230627143524160](./assets/image-20230627143524160.png)



- 已知明文分析

![image-20230616202316834](./assets/image-20230616202316834.png)



![image-20230616202502569](./assets/image-20230616202502569.png)

# 第二章 分组密码

## SPN

![image-20230624164839095](./assets/image-20230624164839095.png)

### 特点

![image-20230624165009371](./assets/image-20230624165009371.png)

## S盒密码分析

### 线性密码分析

![image-20230627203242752](./assets/image-20230627203242752.png)

![image-20230627203318015](./assets/image-20230627203318015.png)



![image-20230624165526362](./assets/image-20230624165526362.png)

![image-20230624165618265](./assets/image-20230624165618265.png)

​	相当于左移, 以0为界

![image-20230624165754509](./assets/image-20230624165754509.png)

![image-20230627203428868](./assets/image-20230627203428868.png)

### 差分密码分析

![image-20230627203800682](./assets/image-20230627203800682.png)

- 对输入异或差分值相同的所有差分对做统计, 以差分对的明显不均匀输出分布为基础来分析最后一轮子密钥

![image-20230627203746041](./assets/image-20230627203746041.png)

## Feistel结构

![image-20230624164727060](./assets/image-20230624164727060.png)

- 加密算法与解密算法相同
- 密钥逆序使用
- F不需要可逆

## DES

![image-20230624173258594](./assets/image-20230624173258594.png)

![image-20230624173613496](./assets/image-20230624173613496.png)

## AES

![image-20230624174457971](./assets/image-20230624174457971.png)

### 字节代换

![image-20230624174523682](./assets/image-20230624174523682.png)

![image-20230627104746781](./assets/image-20230627104746781.png)

### 多项式求逆方法

![image-20230627104806172](./assets/image-20230627104806172.png)



### 列混合变换

![image-20230624175207741](./assets/image-20230624175207741.png)

## 小结

![image-20230624175411203](./assets/image-20230624175411203.png)

## 工作模式(重要)

![image-20230624175431753](./assets/image-20230624175431753.png)

- ECB: 分组用同样的密钥

| 模式 | 优点                                     | 缺点                                                     |
| ---- | ---------------------------------------- | -------------------------------------------------------- |
| ECB  | 简单, 并行, 无错误传播                   | 相同明文变成相同密文, 能被主动攻击替换, 适合传输短消息   |
| CBC  | 不能被替换重排删除重放                   | 不能并行, 需要共同初始化向量, 有错误传播                 |
| CFB  | 隐藏明文                                 | 不能并行, 需要共同的移位寄存器, 有错误传播               |
| OFB  | 可以离线工作                             | 不能并行, 需要共同初始化向量, 有错误传播, 密钥序列会重复 |
| CTR  | 可并行和预处理, 加密数据块随机访问, 简单 | 密钥只能使用一次,除非计数器很长                          |

![image-20230627205537192](./assets/image-20230627205537192.png)

## 密文挪用

![image-20230627205857846](./assets/image-20230627205857846.png)

![image-20230627210009094](./assets/image-20230627210009094.png)

![image-20230627210350115](./assets/image-20230627210350115.png)

- 相当于最后两块交换位置, 先算Cn后算Cn-1
- 记住左边的图即可

![image-20230627205948554](./assets/image-20230627205948554.png)





# 第三章 hash函数

## MD5

![image-20230628110426396](./assets/image-20230628110426396.png)

![image-20230628110445444](./assets/image-20230628110445444.png)

## SHA-1

- padding与MD5相同

![image-20230628110507274](./assets/image-20230628110507274.png)

## hash安全性

![image-20230627210458044](./assets/image-20230627210458044.png)

- 依次增强, 即碰撞稳固性满足其他都满足

### 生日攻击

![image-20230627210548944](./assets/image-20230627210548944.png)

## SHA-1和MD5比较

![image-20230626152033911](./assets/image-20230626152033911.png)

![image-20230627210905311](./assets/image-20230627210905311.png)

## MAC

![image-20230627210958616](./assets/image-20230627210958616.png)

- 记住功能: 数据完整性, 数据源认证

### HMAC

![image-20230626152301502](./assets/image-20230626152301502.png)

- ipad, opad需要记, 36和5C

![image-20230627211159611](./assets/image-20230627211159611.png)

### CBC-MAC & CCM

![image-20230626153859794](./assets/image-20230626153859794.png)

- 跟CBC一样, 迭代, 取最后的输出为结果

![image-20230627211345902](./assets/image-20230627211345902.png)

- 与CBC区别:
  - IV=0, 而CBC是随机数
  - 中间过程不需要保存, 而CBC加密所以需要

# 第四章 公钥密码

## RSA

![image-20230627154037806](./assets/image-20230627154037806.png)

## Rabin

![image-20230627153937846](./assets/image-20230627153937846.png)

## 平方乘算法(模平方)

![image-20230627154100734](./assets/image-20230627154100734.png)

## EIGamal

![image-20230626162036501](./assets/image-20230626162036501.png)

## 椭圆曲线

![image-20230626160148422](./assets/image-20230626160148422.png)

![image-20230626160427434](./assets/image-20230626160427434.png)

- 此处有错误: 
  $$
  x_3=\lambda^2-x_1-x_3 \\
  y_3= \lambda(x_1-x_3)-y_1
  $$
  

![image-20230626163753008](./assets/image-20230626163753008.png)

## 数字签名

![image-20230628105107284](./assets/image-20230628105107284.png)

![image-20230628105125189](./assets/image-20230628105125189.png)

![image-20230628105349326](./assets/image-20230628105349326.png)

![image-20230628105314528](./assets/image-20230628105314528.png)



### EIGamal

![image-20230626203508539](./assets/image-20230626203508539.png)

### DSA

![image-20230626205240190](./assets/image-20230626205240190.png)

## 素性检验

- SS算法

![image-20230626211843126](./assets/image-20230626211843126.png)

- Miller-Rabin

![image-20230626213703556](./assets/image-20230626213703556.png)

## RSA的攻击

### 共模攻击

![image-20230628102455278](./assets/image-20230628102455278.png)

### 小指数加密

![image-20230628102514507](./assets/image-20230628102514507.png)

### 小解密指数

![image-20230628102611204](./assets/image-20230628102611204.png)

![image-20230628102638382](./assets/image-20230628102638382.png)

## DH算法

![image-20230628104826028](./assets/image-20230628104826028.png)

